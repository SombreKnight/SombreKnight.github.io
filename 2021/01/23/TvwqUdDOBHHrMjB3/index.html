<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>《中间件之Redis》系列一：基础总结 | 张晨曦的博客</title><meta name="description" content="​    在这一篇中，我将对Redis的基础使用进行一个全方位的总结。  总结的内容如下：  5种基础数据结构 字符串-string 列表-list 字典-hash 集合-set 有序集合-zset   容器型数据结构的通用规则 过期时间 管道 事务 缓存穿透&#x2F;击穿&#x2F;雪崩   一、5种基础数据结构1. 字符串-string字符串是Redis最简单的数据结构。需要记住以下两点：  redis中的字符"><meta property="og:type" content="article"><meta property="og:title" content="《中间件之Redis》系列一：基础总结"><meta property="og:url" content="https://sombreknight.gitee.io/2021/01/23/TvwqUdDOBHHrMjB3/index.html"><meta property="og:site_name" content="张晨曦的博客"><meta property="og:description" content="​    在这一篇中，我将对Redis的基础使用进行一个全方位的总结。  总结的内容如下：  5种基础数据结构 字符串-string 列表-list 字典-hash 集合-set 有序集合-zset   容器型数据结构的通用规则 过期时间 管道 事务 缓存穿透&#x2F;击穿&#x2F;雪崩   一、5种基础数据结构1. 字符串-string字符串是Redis最简单的数据结构。需要记住以下两点：  redis中的字符"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://sombreknight.gitee.io/2021/01/23/TvwqUdDOBHHrMjB3/image-20210124231704149.png"><meta property="og:image" content="https://sombreknight.gitee.io/2021/01/23/TvwqUdDOBHHrMjB3/image-20210125000342470.png"><meta property="article:published_time" content="2021-01-23T15:30:17.000Z"><meta property="article:modified_time" content="2021-01-23T15:29:34.000Z"><meta property="article:author" content="张晨曦"><meta property="article:tag" content="中间件"><meta property="article:tag" content="Redis"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://sombreknight.gitee.io/2021/01/23/TvwqUdDOBHHrMjB3/image-20210124231704149.png"><link rel="canonical" href="https://sombreknight.gitee.io/2021/01/23/TvwqUdDOBHHrMjB3/index.html"><link rel="alternate" href="/atom.xml" title="张晨曦的博客" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1.4.0/dist/gitalk.min.css"><meta name="generator" content="Hexo 5.3.0"></head><body class="main-center theme-purple" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/SombreKnight" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">张晨曦</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">Java工程师</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Chengdu, China</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">首页</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">归档</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">分类</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">标签</span></a></li><li class="menu-item menu-item-repository"><a href="/repository"><i class="icon icon-project"></i> <span class="menu-title">项目</span></a></li><li class="menu-item menu-item-links"><a href="/links"><i class="icon icon-friendship"></i> <span class="menu-title">友链</span></a></li><li class="menu-item menu-item-about"><a href="/about"><i class="icon icon-cup-fill"></i> <span class="menu-title">关于</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/SombreKnight" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="http://weibo.com/SombreKnight" target="_blank" title="Weibo" data-toggle="tooltip" data-placement="top"><i class="icon icon-weibo"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">公告</h3><div class="widget-body"><div id="board"><div class="content"><p>寄言持重者，微物莫全轻!</p></div></div></div></div><div class="widget"><h3 class="widget-title">分类</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/">Spring</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/Java/">Java</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">系列文章</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8D%9A%E5%AE%A2%E8%AE%A1%E5%88%92/">博客计划</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%AB%98%E5%B9%B6%E5%8F%91%E9%A1%B9%E7%9B%AE/">高并发项目</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%AB%98%E5%B9%B6%E5%8F%91%E9%A1%B9%E7%9B%AE/%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">系列文章</a><span class="category-list-count">3</span></li></ul></li></ul></div></div><div class="widget"><h3 class="widget-title">标签</h3><div class="widget-body"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/" rel="tag">JVM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RabbitMQ/" rel="tag">RabbitMQ</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/" rel="tag">Spring</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" rel="tag">中间件</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%9A%E5%AE%A2%E8%AE%A1%E5%88%92/" rel="tag">博客计划</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" rel="tag">性能优化</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A1%86%E6%9E%B6/" rel="tag">框架</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" rel="tag">消息队列</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" rel="tag">源码分析</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%A2%E5%8C%85/" rel="tag">红包</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%AB%98%E5%B9%B6%E5%8F%91/" rel="tag">高并发</a><span class="tag-list-count">4</span></li></ul></div></div><div class="widget"><h3 class="widget-title">标签云</h3><div class="widget-body tagcloud"><a href="/tags/JVM/" style="font-size:13px">JVM</a> <a href="/tags/Java/" style="font-size:13.33px">Java</a> <a href="/tags/RabbitMQ/" style="font-size:13px">RabbitMQ</a> <a href="/tags/Redis/" style="font-size:13.33px">Redis</a> <a href="/tags/Spring/" style="font-size:13px">Spring</a> <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" style="font-size:13.67px">中间件</a> <a href="/tags/%E5%8D%9A%E5%AE%A2%E8%AE%A1%E5%88%92/" style="font-size:13px">博客计划</a> <a href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" style="font-size:14px">性能优化</a> <a href="/tags/%E6%A1%86%E6%9E%B6/" style="font-size:13px">框架</a> <a href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" style="font-size:13px">消息队列</a> <a href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size:13px">源码分析</a> <a href="/tags/%E7%BA%A2%E5%8C%85/" style="font-size:13.67px">红包</a> <a href="/tags/%E9%AB%98%E5%B9%B6%E5%8F%91/" style="font-size:14px">高并发</a></div></div><div class="widget"><h3 class="widget-title">归档</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a><span class="archive-list-count">6</span></li></ul></div></div><div class="widget"><h3 class="widget-title">最新文章</h3><div class="widget-body"><ul class="recent-post-list list-unstyled no-thumbnail"><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/Java/">Java</a></p><p class="item-title"><a href="/2021/04/19/2VtWIcgxfEv5oIRA/" class="title">优化高并发下获取系统当前时间毫秒数性能问题</a></p><p class="item-date"><time datetime="2021-04-19T00:35:14.000Z" itemprop="datePublished">2021-04-19</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/Spring/">Spring</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/Spring/Java/">Java</a></p><p class="item-title"><a href="/2021/03/21/qDf9nxMp5VywgXFc/" class="title">Spring 框架源码分析</a></p><p class="item-date"><time datetime="2021-03-21T07:31:55.000Z" itemprop="datePublished">2021-03-21</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a></p><p class="item-title"><a href="/2021/02/25/WNC8rxhCVjxb8IWX/" class="title">全方位总结中间件之RabbitMQ</a></p><p class="item-date"><time datetime="2021-02-25T02:18:38.000Z" itemprop="datePublished">2021-02-25</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/Java/">Java</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/Java/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a></p><p class="item-title"><a href="/2021/02/20/TwKQVMOtQ3nL1Dry/" class="title">Java虚拟机的体系结构---运行时数据区</a></p><p class="item-date"><time datetime="2021-02-20T07:44:10.000Z" itemprop="datePublished">2021-02-20</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">系列文章</a></p><p class="item-title"><a href="/2021/01/23/TvwqUdDOBHHrMjB3/" class="title">《中间件之Redis》系列一：基础总结</a></p><p class="item-date"><time datetime="2021-01-23T15:30:17.000Z" itemprop="datePublished">2021-01-23</time></p></div></li></ul></div></div></div></aside><main class="main" role="main"><div class="content"><article id="post-TvwqUdDOBHHrMjB3" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">《中间件之Redis》系列一：基础总结</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2021/01/23/TvwqUdDOBHHrMjB3/" class="article-date"><time datetime="2021-01-23T15:30:17.000Z" itemprop="datePublished">2021-01-23</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a>►<a class="article-category-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/">系列文章</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/Redis/" rel="tag">Redis</a>, <a class="article-tag-link-link" href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" rel="tag">中间件</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/01/23/TvwqUdDOBHHrMjB3/#comments" class="article-comment-link">评论</a></span> <span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 4.1k(字)</span> <span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 18(分)</span></div></div><div class="article-entry marked-body" itemprop="articleBody"><p>​ 在这一篇中，我将对Redis的基础使用进行一个全方位的总结。</p><hr><p>总结的内容如下：</p><ol><li><a href="#part-1">5种基础数据结构</a><ol><li><a href="#string">字符串-string</a></li><li><a href="#list">列表-list</a></li><li><a href="#hash">字典-hash</a></li><li><a href="#set">集合-set</a></li><li><a href="#zset">有序集合-zset</a></li></ol></li><li><a href="#part-2">容器型数据结构的通用规则</a></li><li><a href="#part-3">过期时间</a></li><li><a href="#part-4">管道</a></li><li><a href="#part-5">事务</a></li><li><a href="#part-6">缓存穿透/击穿/雪崩</a></li></ol><hr><h2 id="一、5种基础数据结构"><a href="#一、5种基础数据结构" class="headerlink" title="一、5种基础数据结构"></a><a id="part-1">一、5种基础数据结构</a></h2><h3 id="1-字符串-string"><a href="#1-字符串-string" class="headerlink" title="1. 字符串-string"></a><a id="string">1. 字符串-string</a></h3><p>字符串是Redis最简单的数据结构。需要记住以下两点：</p><ol><li>redis中的字符串是一种可变字符串，内部实现了类似于Java ArrayList的动态扩容机制，当字符串长度小于1MB时，扩容都是直接加倍现有的框架；当字符串长度超过1MB时，扩容一次只会多扩1MB。</li><li>字符串的最大长度时512MB</li></ol><p>基本操作如下：</p><ol><li><p>简单键值对读写</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">set</span> name zhangchenxi</span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> get name</span></span><br><span class="line">&quot;zhangchenxi&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> del name</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> get name</span></span><br><span class="line">(nil)</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> exists name</span></span><br><span class="line">(integer) 0</span><br></pre></td></tr></table></figure></li><li><p>批量键值对读写</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">set</span> name1 zhangsan</span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">set</span> name2 lisi</span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> mget name1 name2 name3</span></span><br><span class="line">1) &quot;zhangsan&quot;</span><br><span class="line">2) &quot;lisi&quot;</span><br><span class="line">3) (nil)</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> mset name1 z3 name2 l4 name3 w5</span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> mget name1 name2 name3</span></span><br><span class="line">1) &quot;z3&quot;</span><br><span class="line">2) &quot;l4&quot;</span><br><span class="line">3) &quot;w5&quot;</span><br></pre></td></tr></table></figure></li><li><p>过期</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">set</span> name zhangchenxi</span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> expire name 5 <span class="comment"># 设置5s后过期</span></span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> get name</span> </span><br><span class="line">&quot;zhangchenxi&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ...5s后...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> get name</span> </span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure></li><li><p>set命令扩展</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> setex name 5 zhangchenxi <span class="comment"># setex 等价于 set + expire</span></span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> get name</span></span><br><span class="line">&quot;zhangchenxi&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ...5s后...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> get name</span></span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> setnx name zhangchenxi <span class="comment"># 当name这个key没有对应的value时，才能set成功</span></span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> get name</span></span><br><span class="line">&quot;zhangchenxi&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> setnx name zhangsan</span></span><br><span class="line">(integer) 0</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> get name</span></span><br><span class="line">&quot;zhangchenxi&quot;</span><br></pre></td></tr></table></figure></li><li><p>计数</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">set</span> age 10  <span class="comment"># 只有当value为整数时，才能使用incr和incrby</span></span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> incr age</span></span><br><span class="line">(integer) 11</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> incr age</span></span><br><span class="line">(integer) 12</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> incr age</span></span><br><span class="line">(integer) 13</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> incrby age 2</span></span><br><span class="line">(integer) 15</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> incrby age 2</span></span><br><span class="line">(integer) 17</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> incrby age -2</span></span><br><span class="line">(integer) 15</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> incrby age -2</span></span><br><span class="line">(integer) 13</span><br><span class="line"><span class="meta">#</span><span class="bash"> -----错误示例-----</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">set</span> age haha</span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> incr age</span></span><br><span class="line">(error) ERR value is not an integer or out of range</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> incrby age 2</span></span><br><span class="line">(error) ERR value is not an integer or out of range</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">set</span> age 11.1</span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> incr age</span></span><br><span class="line">(error) ERR value is not an integer or out of range</span><br></pre></td></tr></table></figure><h3 id="2-列表-list"><a href="#2-列表-list" class="headerlink" title="2. 列表-list"></a><a id="list">2. 列表-list</a></h3></li></ol><p>Redis中的list相当于Java语言里面的LinkedList（实际上底层用了一个QuickList的结构，后续对数据结构源码实现总结时再梳理，这里可以先简单理解为LinkedList），注意它是链表而不是数组。这意味着list的插入和删除操作非常快，时间复杂度为O(1)，但是索引定位很慢，时间复杂度为O(n)。Redis中的list是个双向链表，每个元素都使用双向指针串联，支持前向后向遍历。</p><ol><li><p>作为队列来使用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> rpush queue 1 2 3</span> </span><br><span class="line">(integer) 3</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> rpush queue 4</span></span><br><span class="line">(integer) 4</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> lrange queue 0 -1 <span class="comment"># lrange会遍历链表，时间复杂度O(n),在实际开发中要慎用</span></span></span><br><span class="line">1) &quot;1&quot;</span><br><span class="line">2) &quot;2&quot;</span><br><span class="line">3) &quot;3&quot;</span><br><span class="line">4) &quot;4&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> lpop queue <span class="comment"># O(1)</span></span></span><br><span class="line">&quot;1&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> lpop queue</span></span><br><span class="line">&quot;2&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> lpop queue</span></span><br><span class="line">&quot;3&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> lpop queue</span></span><br><span class="line">&quot;4&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> lpop queue</span></span><br><span class="line">(nil)</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> lrange queue 0 -1</span></span><br><span class="line">(empty list or set)</span><br></pre></td></tr></table></figure></li><li><p>作为栈来使用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> rpush stack a b c</span> </span><br><span class="line">(integer) 3</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> rpush stack d</span></span><br><span class="line">(integer) 4</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> lrange stack 0 -1 <span class="comment"># lrange会遍历链表，时间复杂度O(n),在实际开发中要慎用</span></span></span><br><span class="line">1) &quot;a&quot;</span><br><span class="line">2) &quot;b&quot;</span><br><span class="line">3) &quot;c&quot;</span><br><span class="line">4) &quot;d&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> rpop stack <span class="comment"># O(1)</span></span></span><br><span class="line">&quot;d&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> rpop stack</span></span><br><span class="line">&quot;c&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> rpop stack</span></span><br><span class="line">&quot;b&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> rpop stack</span></span><br><span class="line">&quot;a&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> rpop stack</span></span><br><span class="line">(nil)</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> lrange stack 0 -1</span></span><br><span class="line">(empty list or set)</span><br></pre></td></tr></table></figure></li></ol><ol start="3"><li><p>list的慢操作</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> rpush queue a b c d</span></span><br><span class="line">(integer) 4</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> lindex queue 1 <span class="comment"># lindex操作相当于Java链表中的get(int index)方法，时间复杂度O(n),实际开发中慎用</span></span></span><br><span class="line">&quot;b&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> lrange queue 0 -1 <span class="comment"># lrange操作复杂度O(n)，实际开发中慎用</span></span></span><br><span class="line">1) &quot;a&quot;</span><br><span class="line">2) &quot;b&quot;</span><br><span class="line">3) &quot;c&quot;</span><br><span class="line">4) &quot;d&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ltrim queue 1 2 <span class="comment"># ltrim操作，将start,stop索引之外的元素都删除，复杂度O(n)，实际开发中慎用</span></span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> lrange queue 0 -1</span></span><br><span class="line">1) &quot;b&quot;</span><br><span class="line">2) &quot;c&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> llen queue <span class="comment"># 这个写在这儿是为了和lrange区分，llen是正儿八经的O(1)复杂度，实际开发中放心使用</span></span></span><br><span class="line">(integer 2)</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ltrim queue 1 0 <span class="comment"># 利用ltrim清空list，[1,0]是个负区间，将直接清空ltrim，没啥意义的骚操作，实际开发中千万不能这么玩儿</span></span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> lrange queue 0 -1</span></span><br><span class="line">(empty list or set)</span><br></pre></td></tr></table></figure></li><li><p>作为异步队列使用</p><p>作为异步队列使用的原理大概是：将需要异步处理的任务序列化后存如list，然后在另一个线程对这个列表进行轮询数据处理。</p><p>作为异步队列使用，将放在后面的Redis应用系列文章中总结，这里不再赘述。</p></li></ol><h3 id="3-字典-hash"><a href="#3-字典-hash" class="headerlink" title="3. 字典-hash"></a><a id="hash">3. 字典-hash</a></h3><p>Redis中的字典-Hash结构相当于Java中的HashMap，都是数组+链表的二维结构实现方式。当第一维hash的数组位置碰撞时就会将碰撞元素使用链表串起来。但是和Java的HashMap不同的是：Redis为了追求高性能，使用了渐进式rehash，关于redis的hash结构rehash过程，在后续的深入原理文章中再梳理总结。</p><p><strong>注意：Redis中Hash结构的value，只能存放字符串</strong></p><ol><li><p>基本操作</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> hset person name zhangsan</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> hset person age 18</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> hset person addr beijing</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> hgetall person</span></span><br><span class="line">1) &quot;name&quot;</span><br><span class="line">2) &quot;zhangsan&quot;</span><br><span class="line">3) &quot;age&quot;</span><br><span class="line">4) &quot;18&quot;</span><br><span class="line">5) &quot;addr&quot;</span><br><span class="line">6) &quot;beijing&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> hlen person</span></span><br><span class="line">(integer) 3</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> hget person name</span></span><br><span class="line">&quot;zhangsan&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> hset person name lisi</span></span><br><span class="line">(integer) 0</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> hget person name</span></span><br><span class="line">&quot;lisi&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> hmset person name zhang3 age 20 addr chengdu</span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> hgetall person</span></span><br><span class="line">1) &quot;name&quot;</span><br><span class="line">2) &quot;zhang3&quot;</span><br><span class="line">3) &quot;age&quot;</span><br><span class="line">4) &quot;20&quot;</span><br><span class="line">5) &quot;addr&quot;</span><br><span class="line">6) &quot;chengdu&quot;</span><br></pre></td></tr></table></figure></li><li><p>计数操作</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> hgetall person</span></span><br><span class="line">1) &quot;name&quot;</span><br><span class="line">2) &quot;zhang3&quot;</span><br><span class="line">3) &quot;age&quot;</span><br><span class="line">4) &quot;20&quot;</span><br><span class="line">5) &quot;addr&quot;</span><br><span class="line">6) &quot;chengdu&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> hget person age</span></span><br><span class="line">&quot;20&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> HINCRBY person age 1</span></span><br><span class="line">(integer) 21</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> HINCRBY person age 1</span></span><br><span class="line">(integer) 22</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> HINCRBY person age -1</span></span><br><span class="line">(integer) 21</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> HINCRBY person age -1</span></span><br><span class="line">(integer) 20</span><br></pre></td></tr></table></figure><h3 id="4-集合-set"><a href="#4-集合-set" class="headerlink" title="4. 集合-set"></a><a id="set">4. 集合-set</a></h3></li></ol><p>​ Redis的集合相当于Java的HashSet，内部的键值对是无序的、唯一的。它的内部实现相当于一个特殊的字典（Hash），不过所有的value都是NULL。</p><ol><li><p>基本操作</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> sadd books python</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> sadd books python <span class="comment"># set中已有了，所以返回0</span></span></span><br><span class="line">(integer) 0</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> sadd books java</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> sadd books golang</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> smembers books <span class="comment"># 查询集合的全部元素，顺序和sadd的顺序不一致</span></span></span><br><span class="line">1) &quot;java&quot;</span><br><span class="line">2) &quot;python&quot;</span><br><span class="line">3) &quot;golang&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> sismember books java <span class="comment"># 判断集合中是否存在某个元素，存在返回1，否则返回0</span></span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> sismember books php</span></span><br><span class="line">(integer) 0</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> scard books <span class="comment"># 获取集合的长度</span></span></span><br><span class="line">(integer) 3</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> spop books <span class="comment"># 从集合中“随机”弹出一个元素</span></span></span><br><span class="line">&quot;golang&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> scard books</span></span><br><span class="line">(integer) 2</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> spop books</span></span><br><span class="line">&quot;java&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> scard books</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> spop books</span></span><br><span class="line">&quot;python&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> scard books</span></span><br><span class="line">(integer) 0</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> spop books</span></span><br><span class="line">(nil)</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> scard books</span></span><br><span class="line">(integer) 0</span><br></pre></td></tr></table></figure></li></ol><h3 id="5-有序集合-zset"><a href="#5-有序集合-zset" class="headerlink" title="5. 有序集合-zset"></a><a id="zset">5. 有序集合-zset</a></h3><p>zset是Redis中最具特色的数据结构。一方面它是一个set，保证了内部value的唯一性，另一方面它可以给每个value赋予一个score，表示value的排序权重。它的内部实现用的是一种叫做“跳跃列表”的数据结构。</p><ol><li><p>基础用法</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> zadd language 9.0 java</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zadd language 8.9 python</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zadd language 8.8 php</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zadd language 8.5 c</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zadd language 8.4 c++</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zadd language 8.2 javaScript</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zrange language 0 -1 <span class="comment"># 按score排升序列出，参数区间为排名范围，当区间为负，则全排名输出</span></span></span><br><span class="line">1) &quot;javaScript&quot;</span><br><span class="line">2) &quot;c++&quot;</span><br><span class="line">3) &quot;c&quot;</span><br><span class="line">4) &quot;php&quot;</span><br><span class="line">5) &quot;python&quot;</span><br><span class="line">6) &quot;java&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zrange language 0 2 <span class="comment"># 按score排升序，取出前三名</span></span></span><br><span class="line">1) &quot;javaScript&quot;</span><br><span class="line">2) &quot;c++&quot;</span><br><span class="line">3) &quot;c&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zrevrange language 0 -1 <span class="comment"># 按score将序列出，当区间为负，全排名输出</span></span></span><br><span class="line">1) &quot;java&quot;</span><br><span class="line">2) &quot;python&quot;</span><br><span class="line">3) &quot;php&quot;</span><br><span class="line">4) &quot;c&quot;</span><br><span class="line">5) &quot;c++&quot;</span><br><span class="line">6) &quot;javaScript&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zrevrange language 0 2 <span class="comment"># 按score将序列出，输出前3名</span></span></span><br><span class="line">1) &quot;java&quot;</span><br><span class="line">2) &quot;python&quot;</span><br><span class="line">3) &quot;php&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ----------------------------------------------------------------------------</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zcard language <span class="comment"># 获取zset的长度</span></span></span><br><span class="line">(integer) 6</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zscore language java <span class="comment"># 获取指定value的score，内部score使用double类型存储，所以存在小数点精度问题</span></span></span><br><span class="line">&quot;9&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zscore language python</span></span><br><span class="line">&quot;8.9000000000000004&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zscore language php</span></span><br><span class="line">&quot;8.8000000000000007&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zscore language javaScript</span></span><br><span class="line">&quot;8.1999999999999993&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zrank language java <span class="comment"># 按照score升序排序，获取Java的排名索引</span></span></span><br><span class="line">(integer) 5</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zrank language javaScript <span class="comment"># 按照score升序排序，获取javaScript的排名索引</span></span></span><br><span class="line">(integer) 0</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zrangebyscore language 8.1 8.5 <span class="comment"># 输出[8.1,8.5]区间的升序排名</span></span></span><br><span class="line">1) &quot;javaScript&quot;</span><br><span class="line">2) &quot;c++&quot;</span><br><span class="line">3) &quot;c&quot;</span><br><span class="line">127.0.0.1:6379&gt; zrangebyscore language 8.1 8.5 withscores # 输出[8.1,8.5]区间的升序排名，并且输出score</span><br><span class="line">1) &quot;javaScript&quot;</span><br><span class="line">2) &quot;8.1999999999999993&quot;</span><br><span class="line">3) &quot;c++&quot;</span><br><span class="line">4) &quot;8.4000000000000004&quot;</span><br><span class="line">5) &quot;c&quot;</span><br><span class="line">6) &quot;8.5&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zrangebyscore language -inf 8.5  <span class="comment"># -inf表示负无穷</span></span></span><br><span class="line">1) &quot;javaScript&quot;</span><br><span class="line">2) &quot;c++&quot;</span><br><span class="line">3) &quot;c&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zrangebyscore language -inf 8.5 withscores</span></span><br><span class="line">1) &quot;javaScript&quot;</span><br><span class="line">2) &quot;8.1999999999999993&quot;</span><br><span class="line">3) &quot;c++&quot;</span><br><span class="line">4) &quot;8.4000000000000004&quot;</span><br><span class="line">5) &quot;c&quot;</span><br><span class="line">6) &quot;8.5&quot;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> zrem language c <span class="comment"># 从zset中删除某个value</span></span></span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure><h2 id="二、容器型数据结构的通用规则"><a href="#二、容器型数据结构的通用规则" class="headerlink" title="二、容器型数据结构的通用规则"></a><a id="part-2">二、容器型数据结构的通用规则</a></h2></li></ol><p>List、Set、Hash、Zset这四种数据结构是容器型数据结构。</p><p>它们都有下面两条通用规则：</p><ol><li>create if not exists: 如果容器不存在，就创建一个再进行操作；</li><li>drop if no elements: 如果容器内没有元素了，就删除此容器。</li></ol><h2 id="三、过期时间"><a href="#三、过期时间" class="headerlink" title="三、过期时间"></a><a id="part-3">三、过期时间</a></h2><p>​ Redis所有的数据结构都可以设置过期时间，时间到了，Redis会自动删除相应的对象。需要注意的是，过期是以对象为单位的。比如一个hash结构的过期是整个hash对象过期，而不是其中某个key过期。</p><p>另外，如果一个对象已经设置了过期时间，如果对其重新进行了写入操作，过期时间会失效。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">set</span> name zhangchenxi</span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> expire name 10</span></span><br><span class="line">(integer) 1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ttl name</span></span><br><span class="line">(integer) 8</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">set</span> name aaa</span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ttl name</span></span><br><span class="line">(integer) -1</span><br></pre></td></tr></table></figure><p>关于“过期”这个话题，还不得不提到Redis的过期失效策略。这篇文章不详细写了，后续深入Redis底层实现原理的文章再具体梳理总结下。</p><h2 id="四、管道"><a href="#四、管道" class="headerlink" title="四、管道"></a><a id="part-4">四、管道</a></h2><p>​ 管道（Pipedline）本身并不是Redis服务器直接提供的技术，这个技术本质上是由客户端提供的，跟服务器没有什么直接的关系。客户端通过对管道中的指令列表改变读写顺序就可以大幅节省IO时间。</p><p><img src="/2021/01/23/TvwqUdDOBHHrMjB3/image-20210124231704149.png" alt="image-20210124231704149"></p><p>如上图所示，正常情况下，redis客户端每次请求服务的执行一个指令都要经过一次写&amp;读，如果执行指令越多，读写IO的次数就越多。现在客户端通过管道，对要执行的指令进行重新排序，将多次写和多次读放在一次IO中，这样就大大减少了IO的次数。</p><p>压力测试一下，不使用管道和使用管道后的QPS：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">zhangchenxi➜~» redis-benchmark -t set -q   # 不使用管道，正常情况下测set指令的QPS                                                                         [23:19:57]</span><br><span class="line">SET: 140646.97 requests per second</span><br><span class="line"></span><br><span class="line">zhangchenxi➜~» redis-benchmark -t set -P 2 -q   # 使用管道，管道内并行请求数量为2时，set的qps约为27w                                                                    [23:20:11]</span><br><span class="line">SET: 268817.19 requests per second</span><br><span class="line"></span><br><span class="line">zhangchenxi➜~» redis-benchmark -t set -P 3 -q                                                                       [23:20:29]</span><br><span class="line">SET: 384615.41 requests per second</span><br><span class="line"></span><br><span class="line">zhangchenxi➜~» redis-benchmark -t set -P 4 -q                                                                       [23:20:37]</span><br><span class="line">SET: 490196.09 requests per second</span><br><span class="line"></span><br><span class="line">zhangchenxi➜~» redis-benchmark -t set -P 5 -q                                                                       [23:20:40]</span><br><span class="line">SET: 540540.56 requests per second</span><br><span class="line"></span><br><span class="line">zhangchenxi➜~» redis-benchmark -t set -P 6 -q                                                                       [23:20:44]</span><br><span class="line">SET: 595238.12 requests per second</span><br><span class="line"></span><br><span class="line">zhangchenxi➜~» redis-benchmark -t set -P 7 -q                                                                       [23:20:47]</span><br><span class="line">SET: 613496.94 requests per second</span><br><span class="line"></span><br><span class="line">zhangchenxi➜~» redis-benchmark -t set -P 8 -q                                                                       [23:20:50]</span><br><span class="line">SET: 653594.81 requests per second</span><br><span class="line"></span><br><span class="line">zhangchenxi➜~» redis-benchmark -t set -P 9 -q                                                                       [23:20:52]</span><br><span class="line">SET: 666666.62 requests per second</span><br><span class="line"></span><br><span class="line">zhangchenxi➜~» redis-benchmark -t set -P 10 -q   # 管道内并行请求达到10时，QPS可以达到70W+                                                                   [23:20:56]</span><br><span class="line">SET: 704225.31 requests per second</span><br><span class="line"></span><br><span class="line">zhangchenxi➜~» redis-benchmark -t set -P 11 -q                                                                      [23:20:58]</span><br><span class="line">SET: 689655.19 requests per second</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>压力测试对比，在我的机器上，对一个普通set压测，QPS大概在14w/s, 当使用管道后，管道内的请求数量达到10左右时接近峰值在70W/s左右，再往后QPS不再增加了，因为已经达到了CPU的极限了。由此可见，管道对QPS的提升作用是非常明显且巨大的。</p><h2 id="五、事务"><a href="#五、事务" class="headerlink" title="五、事务"></a><a id="part-5">五、事务</a></h2><p>Redis的事务非常简单，但是其事务模型也非常不严格。我们不能像使用关系型数据库的事务一样来使用Redis事务。</p><hr><p>Redis事务特点如下：</p><ol><li>不是原子性的，某一步失败了，后续的操作还会执行，Redis事务仅仅满足了事务隔离性中的串行化——当前事务有着不被其他事务打断的权利</li><li>Redis事务不支持回滚</li></ol><hr><ol><li><p>基本示例</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; set hot 18 # 将指令加入事务队列了，这个过程会有IO操作</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; incr hot</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; incr hot</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; set test ab</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; incr test # 这里故意让此命令报错，验证Redis事务的原子性</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; exec # 提交后事务队列中的指令一条条的被执行</span><br><span class="line">1) OK</span><br><span class="line">2) (integer) 19</span><br><span class="line">3) (integer) 20</span><br><span class="line">4) OK</span><br><span class="line">5) (error) ERR value is not an integer or out of range # 这里可以看到，确实incr test执行失败了</span><br><span class="line">127.0.0.1:6379&gt; get hot # 发现执行成功了，说明redis事务不具备原子性</span><br><span class="line">&quot;20&quot;</span><br><span class="line">127.0.0.1:6379&gt; get test # 发现执行成功了，说明redis事务不具备原子性</span><br><span class="line">&quot;ab&quot;</span><br><span class="line">127.0.0.1:6379&gt; </span><br></pre></td></tr></table></figure></li><li><p>丢弃事务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; set book javaeee</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; discard</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get book</span><br><span class="line">(nil)</span><br><span class="line">127.0.0.1:6379&gt; </span><br></pre></td></tr></table></figure></li><li><p>利用pipline可以优化加入事务队列中的IO过程，提示效率，以python代码为例</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pipe = redis.pipline(transaction=<span class="literal">True</span>)</span><br><span class="line">pipe.multi()</span><br><span class="line">pipe.incr(<span class="string">&quot;books&quot;</span>)</span><br><span class="line">pipe.incr(<span class="string">&quot;books&quot;</span>)</span><br><span class="line">values = pipe.execute()</span><br></pre></td></tr></table></figure></li></ol><ol start="4"><li><p>利用watch实现一个乐观锁事务，watch的变量如果在事务执行前修改了，事务会整体失败。（<strong>注意：Redis禁止在multi和exec之间执行watch指令，必须在multi之前盯住关键变量，否则报错</strong>）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; watch books # watch指令盯住books变量，如果在事务exec之前，变量发生了变化，则事务会执行失败，返回nil</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; incr books # 在事务执行前悄悄改了book变量的值</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; incr books</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; exec # 执行事务，果然失败了</span><br><span class="line">(nil)</span><br><span class="line">127.0.0.1:6379&gt; get books # 获取值，还是原来的值，事务没有执行成功</span><br><span class="line">&quot;1&quot;</span><br></pre></td></tr></table></figure><h2 id="六、缓存穿透-击穿-雪崩"><a href="#六、缓存穿透-击穿-雪崩" class="headerlink" title="六、缓存穿透/击穿/雪崩"></a><a id="part-6">六、缓存穿透/击穿/雪崩</a></h2></li></ol><p><img src="/2021/01/23/TvwqUdDOBHHrMjB3/image-20210125000342470.png" alt="image-20210125000342470"></p><p>如上图总结所示：</p><h3 id="gt-缓存穿透-lt"><a href="#gt-缓存穿透-lt" class="headerlink" title="&gt; 缓存穿透 &lt;"></a>&gt; 缓存穿透 &lt;</h3><p>解释： 请求到缓存，没有查到数据，又去查数据库了，但是数据库里也没查到，返回后在缓存中依然没有缓存，下一次相同的查询进来仍然会查询数据库，这样就造成了缓存击穿。</p><p>解决方案：</p><ol><li>数据库查询后，即使没有查询出结果，也可以返回一个空值，下次请求就可以直接命中缓存了；</li><li>使用布隆过滤器，先确认下数据是否不存在，避免对redis和数据库的查询</li></ol><h3 id="gt-缓存击穿-lt"><a href="#gt-缓存击穿-lt" class="headerlink" title="&gt; 缓存击穿 &lt;"></a>&gt; 缓存击穿 &lt;</h3><p>解释： 请求到缓存，没有查到数据，又去查数据库了，数据库中查到了，但是在数据库查询结果回写到缓存之前，还有大量查询命中到了数据库上，就造成了缓存击穿。</p><p>解决方案：</p><ol><li>加锁，避免大量请求访问数据库；</li><li>不允许过期，在逻辑上异步更新数据；</li><li>采用二级缓存，L1失效时间短，L2失效时间长。请求优先从L1缓存查询数据，如果未命中，则加锁，保证只有一个线程去数据库中查询数据并更新L1和L2缓存。加锁过程中其他线程可以从L2缓存获取数据。</li></ol><h3 id="gt-缓存雪崩-lt"><a href="#gt-缓存雪崩-lt" class="headerlink" title="&gt; 缓存雪崩 &lt;"></a>&gt; 缓存雪崩 &lt;</h3><p>解释：大量key同一时刻失效，使得同一时刻的大量请求都命中到数据库上了，由此造成缓存雪崩。</p><p>解决方案：</p><ol><li>对Key设置不同的失效时间，避免大量key同时失效；</li><li>缓存预热。在系统启动时，现将数据加入到缓存中预热，保证数据在使用之前缓存中已经有了；</li><li>通过加锁的方式来限流，减轻数据库压力。</li></ol></div><div class="article-footer"><blockquote class="mt-2x"><ul class="post-copyright list-unstyled"><li class="post-copyright-link hidden-xs"><strong>本文链接：</strong> <a href="https://sombreknight.gitee.io/2021/01/23/TvwqUdDOBHHrMjB3/" title="《中间件之Redis》系列一：基础总结" target="_blank" rel="external">https://sombreknight.gitee.io/2021/01/23/TvwqUdDOBHHrMjB3/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！</li></ul></blockquote><div class="panel panel-default panel-badger"><div class="panel-body"><figure class="media"><div class="media-left"><a href="https://github.com/SombreKnight" target="_blank" class="img-burn thumb-sm visible-lg"><img src="/images/avatar.jpg" class="img-rounded w-full" alt=""></a></div><div class="media-body"><h3 class="media-heading"><a href="https://github.com/SombreKnight" target="_blank"><span class="text-dark">张晨曦</span><small class="ml-1x">Java工程师</small></a></h3><div>业精于勤，荒于嬉！</div></div></figure></div></div></div></article><section id="comments"></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2021/02/20/TwKQVMOtQ3nL1Dry/" title="Java虚拟机的体系结构---运行时数据区"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/2021/01/18/kaVJkC1gBmnwKAty/" title="《中间件之Redis》系列：概览"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button><div class="bar-right"></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>感谢您的支持，我会继续努力的!</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">扫码打赏，你说多少就多少</p><p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p></div><div role="tabpanel" class="tab-pane fade" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">扫码打赏，你说多少就多少</p><p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a></li><li role="presentation"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/SombreKnight" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="http://weibo.com/SombreKnight" target="_blank" title="Weibo" data-toggle="tooltip" data-placement="top"><i class="icon icon-weibo"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul><div class="copyright">&copy; 2021 张晨曦<div class="publishby">Theme by <a href="https://github.com/cofess" target="_blank">cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.</div></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"分类",TAGS:"标签",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn.jsdelivr.net/npm/gitalk@1.4.0/dist/gitalk.min.js"></script><script src="//cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><script type="text/javascript">var gitalk=new Gitalk({clientID:"a5da84bef780e059a1e8",clientSecret:"f9dcc6152b0022fde05eb1dc81fb832311b62fb4",repo:"blog-comments",owner:"SombreKnight",admin:["SombreKnight"],id:md5(location.pathname),distractionFreeMode:!0});gitalk.render("comments")</script></body></html>